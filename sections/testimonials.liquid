<section class="testimonials py-16 bg-dark-900/50">
  <div class="container mx-auto px-6">
    {% if section.settings.title != blank %}
      <div class="text-center mb-12">
        {% if section.settings.subtitle != blank %}
          <p class="text-sm font-mono text-primary-500 uppercase tracking-wider mb-4">{{ section.settings.subtitle }}</p>
        {% endif %}
        <h2 class="text-3xl md:text-4xl font-bold text-dark-100 mb-4">{{ section.settings.title }}</h2>
      </div>
    {% endif %}

    {% if section.blocks.size > 0 %}
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for block in section.blocks %}
          <div class="testimonial-card bg-dark-800/50 border border-dark-700/50 rounded-xl p-6 hover:border-primary-500/30 transition-all duration-300" {{ block.shopify_attributes }}>
            <div class="flex items-center gap-1 mb-4">
              {% for i in (1..5) %}
                {% if i <= block.settings.rating %}
                  <svg class="w-5 h-5 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                {% else %}
                  <svg class="w-5 h-5 text-dark-600" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                {% endif %}
              {% endfor %}
            </div>
            
            <p class="text-dark-300 mb-6 leading-relaxed">{{ block.settings.content }}</p>
            
            <div class="flex items-center gap-4">
              {% if block.settings.avatar != blank %}
                <img 
                  src="{{ block.settings.avatar | image_url: width: 100 }}"
                  alt="{{ block.settings.author }}"
                  class="w-12 h-12 rounded-full object-cover"
                  loading="lazy"
                >
              {% else %}
                <div class="w-12 h-12 rounded-full bg-primary-600 flex items-center justify-center text-white font-semibold">
                  {{ block.settings.author | slice: 0 }}
                </div>
              {% endif %}
              <div>
                <p class="font-medium text-dark-100">{{ block.settings.author }}</p>
                {% if block.settings.role != blank %}
                  <p class="text-sm text-dark-500">{{ block.settings.role }}</p>
                {% endif %}
              </div>
              {% if block.settings.verified %}
                <div class="ml-auto">
                  <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-500/10 text-green-400 text-xs font-medium rounded-full">
                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                    </svg>
                    Verified
                  </span>
                </div>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-12">
        <p class="text-dark-500">Add testimonials using the section blocks.</p>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Testimonials",
  "tag": "section",
  "class": "testimonials-section",
  "settings": [
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Customer Reviews"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "What Our Customers Say"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "range",
          "id": "rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5,
          "label": "Rating"
        },
        {
          "type": "textarea",
          "id": "content",
          "label": "Review content",
          "default": "Excellent product quality and fast shipping. The camera exceeded my expectations!"
        },
        {
          "type": "image_picker",
          "id": "avatar",
          "label": "Customer photo"
        },
        {
          "type": "text",
          "id": "author",
          "label": "Customer name",
          "default": "John Doe"
        },
        {
          "type": "text",
          "id": "role",
          "label": "Role / Company",
          "default": "Security Professional"
        },
        {
          "type": "checkbox",
          "id": "verified",
          "label": "Verified purchase",
          "default": true
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonials",
      "blocks": [
        { "type": "testimonial" },
        { "type": "testimonial" },
        { "type": "testimonial" }
      ]
    }
  ]
}
{% endschema %}
