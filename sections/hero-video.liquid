{%- liquid
  assign section_id = 'hero-video-' | append: section.id
-%}

<section 
  id="{{ section_id }}"
  class="np-hero-video"
  style="
    --np-overlay-opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    --np-min-height: {{ section.settings.min_height }}vh;
    --np-min-height-mobile: {{ section.settings.min_height_mobile }}vh;
  "
>
  <div class="np-hero-video__media">
    {%- if section.settings.video_url != blank -%}
      <video 
        class="np-hero-video__video"
        autoplay 
        muted 
        loop 
        playsinline
        poster="{{ section.settings.fallback_image | image_url: width: 1920 }}"
      >
        <source src="{{ section.settings.video_url }}" type="video/mp4">
      </video>
    {%- elsif section.settings.fallback_image != blank -%}
      <img 
        src="{{ section.settings.fallback_image | image_url: width: 1920 }}"
        srcset="
          {{ section.settings.fallback_image | image_url: width: 768 }} 768w,
          {{ section.settings.fallback_image | image_url: width: 1200 }} 1200w,
          {{ section.settings.fallback_image | image_url: width: 1920 }} 1920w
        "
        sizes="100vw"
        alt="{{ section.settings.title | escape }}"
        class="np-hero-video__image"
        loading="eager"
      >
    {%- else -%}
      <div class="np-hero-video__placeholder"></div>
    {%- endif -%}
    <div class="np-hero-video__overlay"></div>
  </div>

  <div class="np-hero-video__content">
    <div class="np-hero-video__logo">
      {%- if section.settings.logo != blank -%}
        <img 
          src="{{ section.settings.logo | image_url: width: 400 }}"
          alt="{{ shop.name }}"
          class="np-hero-video__logo-img"
          loading="eager"
        >
      {%- else -%}
        <div class="np-hero-video__logo-text">
          <svg class="np-hero-video__logo-icon" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M30 5L50 15V35C50 45 40 53 30 55C20 53 10 45 10 35V15L30 5Z" stroke="url(#shield-gradient)" stroke-width="2" fill="none"/>
            <path d="M22 30L28 36L38 24" stroke="url(#shield-gradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <defs>
              <linearGradient id="shield-gradient" x1="10" y1="5" x2="50" y2="55" gradientUnits="userSpaceOnUse">
                <stop stop-color="#0ea5e9"/>
                <stop offset="1" stop-color="#06b6d4"/>
              </linearGradient>
            </defs>
          </svg>
          <span class="np-hero-video__brand">
            <span class="np-hero-video__brand-next">Next</span>
            <span class="np-hero-video__brand-protect">Protect</span>
          </span>
        </div>
      {%- endif -%}
    </div>

    {%- if section.settings.button_text != blank -%}
      <a 
        href="{{ section.settings.button_link }}" 
        class="np-hero-video__button"
        style="
          --np-btn-bg: {{ section.settings.button_bg_color }};
          --np-btn-text: {{ section.settings.button_text_color }};
          --np-btn-border: {{ section.settings.button_border_color }};
        "
      >
        {{ section.settings.button_text }}
      </a>
    {%- endif -%}

    {%- if section.settings.show_scroll_indicator -%}
      <div class="np-hero-video__scroll">
        <span class="np-hero-video__scroll-text">{{ section.settings.scroll_text }}</span>
        <svg class="np-hero-video__scroll-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
        </svg>
      </div>
    {%- endif -%}
  </div>
</section>

<style>
  #{{ section_id }} {
    position: relative;
    min-height: var(--np-min-height-mobile);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  @media (min-width: 768px) {
    #{{ section_id }} {
      min-height: var(--np-min-height);
    }
  }

  #{{ section_id }} .np-hero-video__media {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  #{{ section_id }} .np-hero-video__video,
  #{{ section_id }} .np-hero-video__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  #{{ section_id }} .np-hero-video__placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  }

  #{{ section_id }} .np-hero-video__overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, var(--np-overlay-opacity));
  }

  #{{ section_id }} .np-hero-video__content {
    position: relative;
    z-index: 10;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 2rem;
    min-height: inherit;
  }

  #{{ section_id }} .np-hero-video__logo {
    margin-bottom: 2rem;
  }

  #{{ section_id }} .np-hero-video__logo-img {
    max-width: 300px;
    height: auto;
  }

  @media (min-width: 768px) {
    #{{ section_id }} .np-hero-video__logo-img {
      max-width: 400px;
    }
  }

  #{{ section_id }} .np-hero-video__logo-text {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  #{{ section_id }} .np-hero-video__logo-icon {
    width: 50px;
    height: 50px;
  }

  @media (min-width: 768px) {
    #{{ section_id }} .np-hero-video__logo-icon {
      width: 70px;
      height: 70px;
    }
  }

  #{{ section_id }} .np-hero-video__brand {
    font-size: 2rem;
    font-weight: 700;
    letter-spacing: -0.02em;
  }

  @media (min-width: 768px) {
    #{{ section_id }} .np-hero-video__brand {
      font-size: 3rem;
    }
  }

  #{{ section_id }} .np-hero-video__brand-next {
    color: #ffffff;
  }

  #{{ section_id }} .np-hero-video__brand-protect {
    background: linear-gradient(90deg, #0ea5e9, #06b6d4);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  #{{ section_id }} .np-hero-video__button {
    display: inline-block;
    padding: 0.75rem 2rem;
    background-color: var(--np-btn-bg, transparent);
    color: var(--np-btn-text, #ffffff);
    border: 1px solid var(--np-btn-border, rgba(255,255,255,0.3));
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.3s ease;
    margin-top: 1rem;
  }

  #{{ section_id }} .np-hero-video__button:hover {
    background-color: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.5);
  }

  #{{ section_id }} .np-hero-video__scroll {
    position: absolute;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    animation: np-bounce 2s infinite;
  }

  @keyframes np-bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
    40% { transform: translateX(-50%) translateY(-8px); }
    60% { transform: translateX(-50%) translateY(-4px); }
  }

  #{{ section_id }} .np-hero-video__scroll-icon {
    width: 20px;
    height: 20px;
  }
</style>

{% schema %}
{
  "name": "Hero Video",
  "tag": "section",
  "class": "np-hero-video-section",
  "settings": [
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "text",
      "id": "video_url",
      "label": "Video URL (MP4)",
      "info": "Upload your video to Shopify Files and paste the URL here"
    },
    {
      "type": "image_picker",
      "id": "fallback_image",
      "label": "Fallback image",
      "info": "Shown while video loads or on mobile"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "default": 40,
      "unit": "%",
      "label": "Overlay opacity"
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Custom logo",
      "info": "Leave empty to use default NextProtect logo"
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Shop now"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link",
      "default": "/collections/all"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Button background",
      "default": "transparent"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_border_color",
      "label": "Button border color",
      "default": "rgba(255,255,255,0.3)"
    },
    {
      "type": "header",
      "content": "Scroll indicator"
    },
    {
      "type": "checkbox",
      "id": "show_scroll_indicator",
      "label": "Show scroll indicator",
      "default": true
    },
    {
      "type": "text",
      "id": "scroll_text",
      "label": "Scroll text",
      "default": "Shop now"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "min_height",
      "min": 50,
      "max": 100,
      "step": 5,
      "default": 100,
      "unit": "vh",
      "label": "Minimum height (Desktop)"
    },
    {
      "type": "range",
      "id": "min_height_mobile",
      "min": 50,
      "max": 100,
      "step": 5,
      "default": 100,
      "unit": "vh",
      "label": "Minimum height (Mobile)"
    }
  ],
  "presets": [
    {
      "name": "Hero Video",
      "settings": {
        "button_text": "Shop now",
        "button_link": "/collections/all",
        "show_scroll_indicator": true,
        "scroll_text": "Shop now"
      }
    }
  ]
}
{% endschema %}
